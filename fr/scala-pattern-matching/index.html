<!DOCTYPE html>
<html lang="en" class="dark light">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https:&#x2F;&#x2F;nicokosi.github.io">

    

    
    
    
    <title>
         Jouons avec le pattern matching en Scala
        
    </title>

        
            <meta property="og:title" content="Jouons avec le pattern matching en Scala" />
        
     

     
         
             <meta property="og:description" content="Le pattern matching est une technique puissante permettant de filtrer et de tester la valeur de variables. Le but de cet article est d‚Äôillustrer par l&#x27;exemple le pattern matching en Scala." />
         
     

     
         
             <meta name="description" content="Le pattern matching est une technique puissante permettant de filtrer et de tester la valeur de variables. Le but de cet article est d‚Äôillustrer par l&#x27;exemple le pattern matching en Scala." />
         
    

    
    

    
    
        <link href=https://nicokosi.github.io/fonts.css rel="stylesheet" />
    

    
    

    
    

    
    

    
    

    

    
    <link rel="alternate" type="application/atom+xml" title="" href="https://nicokosi.github.io/atom.xml">


    
    
        <link rel="stylesheet" type="text/css" href=https://nicokosi.github.io/theme/light.css />
        <link rel="stylesheet" type="text/css" href="https://nicokosi.github.io/theme/dark.css" media="(prefers-color-scheme: dark)" />
    

    <!-- Set the correct theme in the script -->
    <script src=https://nicokosi.github.io/js/themetoggle.js></script>
    
        <script>
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                setTheme("dark");
            } else {
                setTheme("light");
            }
        </script>
    

    <link rel="stylesheet" type="text/css" media="screen" href=https://nicokosi.github.io/main.css />

    

    <script src=https://nicokosi.github.io/js/mermaid.js></script>

    </head>


<body>
    <div class="content">
        <header>
    <div class="main">
        
            <a href=https:&#x2F;&#x2F;nicokosi.github.io></a>
        


        <div class="socials">
            
            <a rel="me" href="https:&#x2F;&#x2F;fosstodon.org&#x2F;@nicokosi" class="social">
                <img alt=mastodon src=https://nicokosi.github.io/social_icons/mastodon.svg>
            </a>
            
            <a rel="me" href="https:&#x2F;&#x2F;bsky.app&#x2F;profile&#x2F;nicokosi.bsky.social" class="social">
                <img alt=bluesky src=https://nicokosi.github.io/social_icons/bluesky.svg>
            </a>
            
            <a rel="me" href="https:&#x2F;&#x2F;github.com&#x2F;nicokosi&#x2F;" class="social">
                <img alt=github src=https://nicokosi.github.io/social_icons/github.svg>
            </a>
            
        </div>
    </div>

    <nav>
        
            <a href=https://nicokosi.github.io style="margin-left: 0.25em">posts</a>
        
            <a href=https://nicokosi.github.io/tags style="margin-left: 0.25em">tags</a>
        
            <a href=https://nicokosi.github.io/fr style="margin-left: 0.25em">üåê fr</a>
        
            <a href=https://nicokosi.github.io style="margin-left: 0.25em">üåê en</a>
        

        

        
    </nav>
</header>


        
        
    
<main>
    <article>
        <div class="title">
            
            
    <div class="page-header">
        Jouons avec le pattern matching en Scala<span class="primary-color" style="font-size: 1.6em">.</span>
    </div>


                <div class="meta">
                    
                        Posted on <time>2016-09-14</time>
                    

                    

                    

                    
                    
                            <span class="tags-label"> :: Tags:</span>
                            <span class="tags">
                                    <a href="https://nicokosi.github.io/fr/tags/scala/" class="post-tag">scala</a>, 
                                
                                    <a href="https://nicokosi.github.io/fr/tags/pattern-matching/" class="post-tag">pattern-matching</a>, 
                                
                                    <a href="https://nicokosi.github.io/fr/tags/console/" class="post-tag">console</a>, 
                                
                                    <a href="https://nicokosi.github.io/fr/tags/repl/" class="post-tag">repl</a>
                                
                            </span>
                    

                    
                    

                    

                </div>
        </div>

        

        
        

        <section class="body">
            <h1 id="jouons-avec-le-pattern-matching-en-scala">Jouons avec le pattern matching en Scala</h1>
<p>Le pattern matching est une technique puissante permettant de filtrer et de tester la valeur de variables. Le but de cet article est d‚Äôillustrer par l'exemple le pattern matching en Scala.</p>
<p>Supposons que nous voulions cr√©er une fonction retournant la couleur (noir / rouge) d'une enseigne d'une carte √† jouer (les quatre enseignes du jeu fran√ßais √©tant : tr√®fle, c≈ìur, carreau et pique).</p>
<p>Notes : dans le code ci-dessous, les commentaires se trouvant √† la fin de chaque ligne correspondent √† la sortie standard de la console ; j'ai utilis√© un <a href="https://confluence.jetbrains.com/display/IntelliJIDEA/Working+with+Scala+Worksheet">worksheet IntelliJ IDEA</a> pour coder interactivement cet exemple, mais on peut bien s√ªr utiliser la console Scala.</p>
<br/>
## 1√®re √©tape : cr√©ation d'une simple classe
<p>Commen√ßons par cr√©er une classe immuable repr√©sentant l'enseigne "tr√®fle" :</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#b48ead;">class</span><span style="color:#ebcb8b;"> Tr√®fle </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">   </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">symbole </span><span>= &quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;
</span><span style="color:#eff1f5;">   </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">libell√© </span><span>= &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;
</span><span style="color:#eff1f5;">}
</span><span>
</span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">tr√®fle</span><span>: </span><span style="color:#ebcb8b;">Tr√®fle </span><span>= </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Tr√®fle</span><span>()
</span><span>tr√®fle.symbole </span><span style="color:#65737e;">// ‚ô£
</span></code></pre>
<p>Notons que cette classe permet de comparer des objets par identit√© (r√©f√©rence) et non par valeur car on ne surcharge pas la m√©thode <code>equals</code> :</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span>tr√®fle.equals(tr√®fle) </span><span style="color:#65737e;">// true
</span><span>tr√®fle == </span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Tr√®fle </span><span style="color:#65737e;">// false
</span><span>tr√®fle.eq(</span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Tr√®fle</span><span>) </span><span style="color:#65737e;">// false
</span><span>tr√®fle.equals(</span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Tr√®fle</span><span>) </span><span style="color:#65737e;">// false
</span></code></pre>
<p>De m√™me, les m√©thodes <code>hashCode</code>, <code>toString</code> sont celles par d√©faut :</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span>tr√®fle </span><span style="color:#65737e;">// Tr√®fle@1ac88f64
</span><span>tr√®fle.hashCode() </span><span style="color:#65737e;">// 123717365
</span><span style="color:#b48ead;">new </span><span style="color:#ebcb8b;">Tr√®fle</span><span>().hashCode() </span><span style="color:#65737e;">// 1323753063
</span></code></pre>
<br/>
## 2√®me √©tape : cr√©ation d'une case class
<p>La cr√©ation d'une <code>case class</code> permet :</p>
<ol>
<li>d'auto-impl√©menter les m√©thodes <code>equals</code>, <code>hashCode</code> et <code>toString</code> ;</li>
<li>de b√©n√©ficier de deux m√©thodes utiles au pattern matching : un "constructeur", la m√©thode <code>apply</code>, et un "d√©-constructeur", la m√©thode <code>unapply</code>.</li>
</ol>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#b48ead;">case class</span><span style="color:#ebcb8b;"> Enseigne</span><span>(</span><span style="color:#bf616a;">symbole</span><span>: </span><span style="color:#ebcb8b;">String</span><span>, </span><span style="color:#bf616a;">libell√©</span><span>: </span><span style="color:#ebcb8b;">String</span><span>)
</span></code></pre>
<p>Nous avons un constructeur "gratuit", la m√©thode <code>apply</code>:</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;) </span><span style="color:#65737e;">// Enseigne(‚ô£,tr√®fle)
</span></code></pre>
<p>Nous avons √©galement une impl√©mentation "gratuite", bas√©e sur les champs, des m√©thodes <code>equals</code>, <code>hashCode</code> et <code>toString</code> :</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;).symbole </span><span style="color:#65737e;">// ‚ô£
</span><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;) == Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;) </span><span style="color:#65737e;">// true
</span><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;).equals(Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;)) </span><span style="color:#65737e;">// true
</span><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;).eq(Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;)) </span><span style="color:#65737e;">// false
</span><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;).hashCode() </span><span style="color:#65737e;">// 841520215
</span><span>Enseigne(&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;).hashCode() </span><span style="color:#65737e;">// 841520215
</span></code></pre>
<br/>
## Etape "bonus" : cr√©ation d'une √©num√©ration
<p>Puisque nous avons quatre enseignes, nous pouvons cr√©er une √©num√©ration. Ca ne servira pas directement √† impl√©menter notre exemple final mais l'exemple s'y pr√™te bien.</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#b48ead;">object</span><span style="color:#ebcb8b;"> Enseignes </span><span style="color:#eff1f5;">{
</span><span style="color:#eff1f5;">  </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">TREFLE </span><span>= </span><span style="color:#eff1f5;">Enseigne(</span><span>&quot;</span><span style="color:#a3be8c;">‚ô£</span><span>&quot;</span><span style="color:#eff1f5;">, </span><span>&quot;</span><span style="color:#a3be8c;">tr√®fle</span><span>&quot;</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">  </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">CARREAU </span><span>= </span><span style="color:#eff1f5;">Enseigne(</span><span>&quot;</span><span style="color:#a3be8c;">‚ô¶</span><span>&quot;</span><span style="color:#eff1f5;">, </span><span>&quot;</span><span style="color:#a3be8c;">carreau</span><span>&quot;</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">  </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">COEUR </span><span>= </span><span style="color:#eff1f5;">Enseigne(</span><span>&quot;</span><span style="color:#a3be8c;">‚ô•</span><span>&quot;</span><span style="color:#eff1f5;">, </span><span>&quot;</span><span style="color:#a3be8c;">coeur</span><span>&quot;</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">  </span><span style="color:#b48ead;">val </span><span style="color:#bf616a;">PIQUE </span><span>= </span><span style="color:#eff1f5;">Enseigne(</span><span>&quot;</span><span style="color:#a3be8c;">‚ô†</span><span>&quot;</span><span style="color:#eff1f5;">, </span><span>&quot;</span><span style="color:#a3be8c;">pique</span><span>&quot;</span><span style="color:#eff1f5;">)
</span><span style="color:#eff1f5;">  </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">values</span><span style="color:#eff1f5;">() </span><span>= </span><span style="color:#eff1f5;">List(CARREAU, COEUR, PIQUE, TREFLE)
</span><span style="color:#eff1f5;">}
</span><span>Enseignes.TREFLE != Enseignes.CARREAU </span><span style="color:#65737e;">// true
</span><span>Enseignes.values </span><span style="color:#65737e;">// List[Enseigne] = List(Enseigne(‚ô¶,carreau), Enseigne(‚ô•,coeur), Enseigne(‚ô†,pique), Enseigne(‚ô£,tr√®fle))
</span></code></pre>
<br/>
## Derni√®re √©tape : pattern matchons !
<h3 id="premier-exemple">Premier exemple</h3>
<p>Un premier exemple de pattern matching, utilis√© dans une fonction qui retourne la couleur de l'enseigne :</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">indiquerJusteLaCouleur</span><span>(</span><span style="color:#bf616a;">cardSuite</span><span>: </span><span style="color:#ebcb8b;">Enseigne</span><span>): </span><span style="color:#ebcb8b;">String </span><span>= cardSuite </span><span style="color:#b48ead;">match </span><span>{
</span><span>  </span><span style="color:#b48ead;">case </span><span>Enseignes.TREFLE | Enseignes.PIQUE </span><span style="color:#b48ead;">=&gt; </span><span>&quot;</span><span style="color:#a3be8c;">noir</span><span>&quot;
</span><span>  </span><span style="color:#b48ead;">case </span><span>Enseignes.CARREAU | Enseignes.COEUR </span><span style="color:#b48ead;">=&gt; </span><span>&quot;</span><span style="color:#a3be8c;">rouge</span><span>&quot;
</span><span>  </span><span style="color:#b48ead;">case </span><span style="color:#bf616a;">_ </span><span style="color:#b48ead;">=&gt; </span><span>&quot;</span><span style="color:#a3be8c;">aucune</span><span>&quot;
</span><span>}
</span><span>
</span><span>indiquerJusteLaCouleur(Enseignes.PIQUE) </span><span style="color:#65737e;">// noir
</span></code></pre>
<p>Ce premier exemple met en avant :</p>
<ul>
<li>la notation <code>|</code> (<em>disjunction</em>) permettant de regrouper plusieurs cas ;</li>
<li>la notation <code>_</code> (<em>wildcard</em>) pour g√©rer les autres cas.</li>
</ul>
<h3 id="deuxieme-exemple">Deuxi√®me exemple</h3>
<p>Voici un deuxi√®me exemple montrant comment r√©cup√©rer s√©lectivement certains champs (ici, le libell√© de l'enseigne) en "d√©-structurant" notre instance de <code>case class</code>, via la m√©thode <code>unapply</code>.</p>
<pre data-lang="scala" style="background-color:#2b303b;color:#c0c5ce;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">d√©crireLaCouleur</span><span>(</span><span style="color:#bf616a;">enseigne</span><span>: </span><span style="color:#ebcb8b;">Enseigne</span><span>): </span><span style="color:#ebcb8b;">String </span><span>= enseigne </span><span style="color:#b48ead;">match </span><span>{
</span><span>  </span><span style="color:#b48ead;">case </span><span>Enseigne(</span><span style="color:#bf616a;">_</span><span>, </span><span style="color:#bf616a;">libell√©</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span style="color:#96b5b4;">s</span><span>&quot;</span><span style="color:#bf616a;">$libell√©</span><span style="color:#a3be8c;"> is ${</span><span>indiquerJusteLaCouleur(enseigne)</span><span style="color:#a3be8c;">}</span><span>&quot;
</span><span>}
</span><span>
</span><span>d√©crireLaCouleur(Enseignes.PIQUE) </span><span style="color:#65737e;">// pique est noir
</span></code></pre>
<p>Et voil√† ! ü§ì</p>
<p>PS : merci √† J√©r√¥me Prudent pour ses tuyaux en Scala et ses avis √©clair√©s.
J√©r√¥me est contributeur au <a href="http://www.arolla.fr/blog">blog d'Arolla</a> (<a href="http://www.arolla.fr/blog/author/jerome-prudent/">lien direct vers ses articles</a>).</p>

        </section>
    </article>
</main>



        
            
        

        
    </div>
</body>

</html>
