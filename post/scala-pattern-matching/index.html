<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Jouons avec le pattern matching en Scala | Le blog de Nicokosi</title>
<link rel="stylesheet" href="https://nicokosi.github.io//css/style.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/github.min.css">


<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <img src="/images/nicokosi.jpg" width="90" height="90" alt="Le blog de Nicokosi" title="Le blog de Nicokosi"/>
        <a class="nav-item" href="https://nicokosi.github.io/"><h1 class="title is-4">Le blog de Nicokosi</h1></a>
      </div>
      <div>
        
            
              
              
              <a href="https://nicokosi.github.io/en/post/scala-pattern-matching/">üá¨üáß english version</a>
              
            
        
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/nicokosi">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://twitter.com/nicokosi">
            <span class="icon">
              <i class="fa fa-twitter"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://www.linkedin.com/in/nicolas-kosinski-95184811">
            <span class="icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h2 class="subtitle is-6">September 14, 2016</h2>
    <h1 class="title">Jouons avec le pattern matching en Scala</h1>
    <div class="content">
      

<p>Le pattern matching est une technique puissante permettant de filtrer et de tester la valeur de variables. Le but de cet article est d‚Äôillustrer par l&rsquo;exemple le pattern matching en Scala.</p>

<p>Supposons que nous voulions cr√©er une fonction retournant la couleur (noir / rouge) d&rsquo;une enseigne d&rsquo;une carte √† jouer (les quatre enseignes du jeu fran√ßais √©tant : tr√®fle, c≈ìur, carreau et pique).</p>

<p>Notes : dans le code ci-dessous, les commentaires se trouvant √† la fin de chaque ligne correspondent √† la sortie standard de la console ; j&rsquo;ai utilis√© un <a href="https://confluence.jetbrains.com/display/IntelliJIDEA/Working+with+Scala+Worksheet">worksheet IntelliJ IDEA</a> pour coder interactivement cet exemple, mais on peut bien s√ªr utiliser la console Scala.</p>

<p><br/></p>

<h2 id="1√®re-√©tape-cr√©ation-d-une-simple-classe">1√®re √©tape : cr√©ation d&rsquo;une simple classe</h2>

<p>Commen√ßons par cr√©er une classe immuable repr√©sentant l&rsquo;enseigne &ldquo;tr√®fle&rdquo; :</p>

<pre><code class="language-scala">class Tr√®fle {
   val symbole = &quot;‚ô£&quot;
   val libell√© = &quot;tr√®fle&quot;
}

val tr√®fle: Tr√®fle = new Tr√®fle()
tr√®fle.symbole // ‚ô£
</code></pre>

<p>Notons que cette classe permet de comparer des objets par identit√© (r√©f√©rence) et non par valeur car on ne surcharge pas la m√©thode <code>equals</code> :</p>

<pre><code class="language-scala">tr√®fle.equals(tr√®fle) // true
tr√®fle == new Tr√®fle // false
tr√®fle.eq(new Tr√®fle) // false
tr√®fle.equals(new Tr√®fle) // false
</code></pre>

<p>De m√™me, les m√©thodes <code>hashCode</code>, <code>toString</code> sont celles par d√©faut :</p>

<pre><code class="language-scala">tr√®fle // Tr√®fle@1ac88f64
tr√®fle.hashCode() // 123717365
new Tr√®fle().hashCode() // 1323753063
</code></pre>

<p><br/></p>

<h2 id="2√®me-√©tape-cr√©ation-d-une-case-class">2√®me √©tape : cr√©ation d&rsquo;une case class</h2>

<p>La cr√©ation d&rsquo;une <code>case class</code> permet :</p>

<ol>
<li>d&rsquo;auto-impl√©menter les m√©thodes <code>equals</code>, <code>hashCode</code> et <code>toString</code> ;</li>
<li>de b√©n√©ficier de deux m√©thodes utiles au pattern matching : un &ldquo;constructeur&rdquo;, la m√©thode <code>apply</code>, et un &ldquo;d√©-constructeur&rdquo;, la m√©thode <code>unapply</code>.</li>
</ol>

<pre><code class="language-scala">case class Enseigne(symbole: String, libell√©: String)
</code></pre>

<p>Nous avons un constructeur &ldquo;gratuit&rdquo;, la m√©thode <code>apply</code>:</p>

<pre><code class="language-scala">Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;) // Enseigne(‚ô£,tr√®fle)
</code></pre>

<p>Nous avons √©galement une impl√©mentation &ldquo;gratuite&rdquo;, bas√©e sur les champs, des m√©thodes <code>equals</code>, <code>hashCode</code> et <code>toString</code> :</p>

<pre><code class="language-scala">Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;).symbole // ‚ô£
Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;) == Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;) // true
Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;).equals(Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;)) // true
Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;).eq(Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;)) // false
Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;).hashCode() // 841520215
Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;).hashCode() // 841520215
</code></pre>

<p><br/></p>

<h2 id="etape-bonus-cr√©ation-d-une-√©num√©ration">Etape &ldquo;bonus&rdquo; : cr√©ation d&rsquo;une √©num√©ration</h2>

<p>Puisque nous avons quatre enseignes, nous pouvons cr√©er une √©num√©ration. Ca ne servira pas directement √† impl√©menter notre exemple final mais l&rsquo;exemple s&rsquo;y pr√™te bien.</p>

<pre><code class="language-scala">object Enseignes {
  val TREFLE = Enseigne(&quot;‚ô£&quot;, &quot;tr√®fle&quot;)
  val CARREAU = Enseigne(&quot;‚ô¶&quot;, &quot;carreau&quot;)
  val COEUR = Enseigne(&quot;‚ô•&quot;, &quot;coeur&quot;)
  val PIQUE = Enseigne(&quot;‚ô†&quot;, &quot;pique&quot;)
  def values() = List(CARREAU, COEUR, PIQUE, TREFLE)
}
Enseignes.TREFLE != Enseignes.CARREAU // true
Enseignes.values // List[Enseigne] = List(Enseigne(‚ô¶,carreau), Enseigne(‚ô•,coeur), Enseigne(‚ô†,pique), Enseigne(‚ô£,tr√®fle))
</code></pre>

<p><br/></p>

<h2 id="derni√®re-√©tape-pattern-matchons">Derni√®re √©tape : pattern matchons !</h2>

<h3 id="premier-exemple">Premier exemple</h3>

<p>Un premier exemple de pattern matching, utilis√© dans une fonction qui retourne la couleur de l&rsquo;enseigne :</p>

<pre><code class="language-scala">def indiquerJusteLaCouleur(cardSuite: Enseigne): String = cardSuite match {
  case Enseignes.TREFLE | Enseignes.PIQUE =&gt; &quot;noir&quot;
  case Enseignes.CARREAU | Enseignes.COEUR =&gt; &quot;rouge&quot;
  case _ =&gt; &quot;aucune&quot;
}

indiquerJusteLaCouleur(Enseignes.PIQUE) // noir
</code></pre>

<p>Ce premier exemple met en avant :</p>

<ul>
<li>la notation <code>|</code> (<em>disjunction</em>) permettant de regrouper plusieurs cas ;</li>
<li>la notation <code>_</code> (<em>wildcard</em>) pour g√©rer les autres cas.</li>
</ul>

<h3 id="deuxi√®me-exemple">Deuxi√®me exemple</h3>

<p>Voici un deuxi√®me exemple montrant comment r√©cup√©rer s√©lectivement certains champs (ici, le libell√© de l&rsquo;enseigne) en &ldquo;d√©-structurant&rdquo; notre instance de <code>case class</code>, via la m√©thode <code>unapply</code>.</p>

<pre><code class="language-scala">def d√©crireLaCouleur(enseigne: Enseigne): String = enseigne match {
  case Enseigne(_, libell√©) =&gt; s&quot;$libell√© is ${indiquerJusteLaCouleur(enseigne)}&quot;
}

d√©crireLaCouleur(Enseignes.PIQUE) // pique est noir
</code></pre>

<p>Et voil√† ! ü§ì</p>

<p>PS : merci √† J√©r√¥me Prudent pour ses tuyaux en Scala et ses avis √©clair√©s.
J√©r√¥me est contributeur au <a href="http://www.arolla.fr/blog">blog d&rsquo;Arolla</a> (<a href="http://www.arolla.fr/blog/author/jerome-prudent/">lien direct vers ses articles</a>).</p>

    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
      var disqus_shortname = 'nicokosi-blog';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="https://github.com/nicokosi">Nicolas Kosinski</a> 2016</p>
  </div>
</section>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/java.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/scala.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/clojure.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/haskell.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/languages/shell.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>

<script>
!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-11930016-2","auto"),ga("send","pageview");
</script>


